{"version":3,"sources":["minimux.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_typeof","Symbol","iterator","obj","constructor","listeners","containers","middleware","state","mutableState","callbackOnion","coreFunction","action","type","forEach","el","Object","keys","key","dispatch","rerender","arguments","undefined","Array","isArray","idx","hasOwnProperty","sort","b","priority","reduce","nextLayer","layer","currentAction","func","updater","enqueueForceUpdate","listen","callback","index","push","remove","connect","container","apply","newMiddleware","unshift","getState"],"mappings":"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","file":"minimux.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\n/*\n * Minimux v1.0.0\n * Author: Steven Barnett (stevendesu) <steven.abarnett@gmail.com>\n * License: MIT +no-false-attribs (https://spdx.org/licenses/MITNFA.html)\n *\n * I made this library because I liked the ideology of Redux, but not the\n * implementation. This is my attempt to rebuild Redux with absolute minimal\n * functionality and to allow for absolute minimal bootstrapping in order to\n * write effective code.\n *\n * Now that I've knocked out all of my \"TODO\"s, I'm officially calling this the\n * end of \"patches\", and from now on a patch will only be a bugfix. Any feature\n * additions will be minor updates.\n *\n * Considerations:\n *  - Two of our functions (connect and apply) are one-liners... why not just\n *    make \"containers\" and \"middleware\" public?\n *  - What should be the return values of each function?\n *  - How do you UNbind middleware or DISconnect containers? Or UNlisten?\n *  - Should it be possible to connect to a subset of the state? If you could\n *    bind reducers to subsets of state then it would be more modular\n */\n\nvar listeners = {};\nvar containers = [];\nvar middleware = [];\n\nvar state = {};\nvar mutableState = {};\n\n// The \"onion\" describes the layers of middleware that we must parse through\n// in order to execute our action.\nvar callbackOnion = null;\n\nvar coreFunction = function coreFunction(action) {\n\tif (listeners[action.type]) {\n\t\tlisteners[action.type].forEach(function (el) {\n\t\t\tstate = el(state, action);\n\t\t\t// This is a temporary (and hideous) hack to maintain backwards compatibility until I'm happy enough with\n\t\t\t// the API to release v2.0.0\n\t\t\t// Previously you could \"import { state } from 'minimux'\" and it was properly updated\n\t\t\t// This was poor practice because it allowed anyone to edit the state without using actions\n\t\t\t// A getState() function has been added to return only the most recent immutable state\n\t\t\tObject.keys(mutableState).forEach(function (key) {\n\t\t\t\tdelete mutableState[key];\n\t\t\t});\n\t\t\tObject.keys(state).forEach(function (key) {\n\t\t\t\tmutableState[key] = state[key];\n\t\t\t});\n\t\t});\n\t}\n\treturn state;\n};\n\nvar dispatch = function dispatch(action) {\n\tvar rerender = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\n\tif (\"development\" !== \"production\") {\n\t\tif ((typeof action === \"undefined\" ? \"undefined\" : _typeof(action)) !== \"object\") {\n\t\t\tthrow \"Invalid type (\" + (typeof action === \"undefined\" ? \"undefined\" : _typeof(action)) + \") for argument \\\"action\\\" passed to dispatch. Expected \" + \"object or array of objects.\";\n\t\t}\n\t\tif (Array.isArray(action)) {\n\t\t\taction.forEach(function (el, idx) {\n\t\t\t\tif ((typeof el === \"undefined\" ? \"undefined\" : _typeof(el)) !== \"object\" || Array.isArray(el)) {\n\t\t\t\t\tthrow \"Invalid type (\" + (typeof el === \"undefined\" ? \"undefined\" : _typeof(el)) + \") for action at index \" + idx + \" passed to dispatch. \" + \"Expected object.\";\n\t\t\t\t}\n\t\t\t\tif (!el.hasOwnProperty(\"type\")) {\n\t\t\t\t\tthrow \"Action at index \" + idx + \" passed to dispatch was missing required property: \\\"type\\\"\";\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (!action.hasOwnProperty(\"type\")) {\n\t\t\tthrow \"Action passed to dispatch was missing required property: \\\"type\\\"\";\n\t\t}\n\t\tif (typeof rerender !== \"boolean\") {\n\t\t\tthrow \"Invalid type (\" + (typeof rerender === \"undefined\" ? \"undefined\" : _typeof(rerender)) + \") for argument \\\"rerender\\\" passed to dispatch. Expected \" + \"boolean.\";\n\t\t}\n\t}\n\tif (callbackOnion === null) {\n\t\tmiddleware.sort(function (a, b) {\n\t\t\treturn a.priority - b.priority;\n\t\t});\n\t\tcallbackOnion = middleware.reduce(function (nextLayer, layer) {\n\t\t\treturn function (currentAction) {\n\t\t\t\treturn layer.func(currentAction, nextLayer);\n\t\t\t};\n\t\t}, coreFunction);\n\t}\n\tif (!Array.isArray(action)) {\n\t\taction = [action];\n\t}\n\taction.forEach(function (el) {\n\t\tstate = callbackOnion(el);\n\t});\n\tif (rerender) {\n\t\tcontainers.forEach(function (el) {\n\t\t\tel.updater.enqueueForceUpdate(el);\n\t\t});\n\t}\n};\n\nvar listen = function listen(type, callback) {\n\tif (\"development\" !== \"production\") {\n\t\tif (typeof type !== \"string\") {\n\t\t\tthrow \"Invalid type (\" + (typeof type === \"undefined\" ? \"undefined\" : _typeof(type)) + \") for argument \\\"type\\\" passed to listen. Expected string.\";\n\t\t}\n\t\tif (typeof callback !== \"function\") {\n\t\t\tthrow \"Invalid type (\" + (typeof callback === \"undefined\" ? \"undefined\" : _typeof(callback)) + \") for argument \\\"callback\\\" passed to listen. Expected \" + \"function.\";\n\t\t}\n\t}\n\tlisteners[type] = listeners[type] || [];\n\tvar index = listeners[type].push(callback) - 1;\n\treturn {\n\t\tremove: function remove() {\n\t\t\tdelete listeners[type][index];\n\t\t}\n\t};\n};\n\nvar connect = function connect(container) {\n\tif (\"development\" !== \"production\") {\n\t\tif ((typeof container === \"undefined\" ? \"undefined\" : _typeof(container)) !== \"object\") {\n\t\t\tthrow \"Invalid type (\" + (typeof container === \"undefined\" ? \"undefined\" : _typeof(container)) + \") for argument \\\"container\\\" passed to listen. Expected \" + \"object.\";\n\t\t}\n\t\t// TODO: Test for ReactDOM.render() return value?\n\t\t// Maybe not, actually. I want to get rid of that dependency...\n\t}\n\tcontainers.push(container);\n};\n\nvar apply = function apply(newMiddleware) {\n\tvar priority = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n\tif (\"development\" !== \"production\") {\n\t\tif (typeof newMiddleware !== \"function\") {\n\t\t\tthrow \"Invalid type (\" + (typeof newMiddleware === \"undefined\" ? \"undefined\" : _typeof(newMiddleware)) + \") for argument \\\"newMiddleware\\\" passed to listen. \" + \"Expected function.\";\n\t\t}\n\t\tif (typeof priority !== \"number\") {\n\t\t\tthrow \"Invalid type (\" + (typeof priority === \"undefined\" ? \"undefined\" : _typeof(priority)) + \") for argument \\\"priority\\\" passed to listen. Expected \" + \"number.\";\n\t\t}\n\t}\n\tmiddleware.unshift({ priority: priority, func: newMiddleware });\n\t// Additional middleware was added. We need to recalulate this guy.\n\tcallbackOnion = null;\n};\n\nvar getState = function getState() {\n\treturn state;\n};\n\n// Switching to CommonJS allowed a bit better name mangling for dat mad compression\nmodule.exports = {\n\tstate: mutableState,\n\tgetState: getState,\n\tdispatch: dispatch,\n\tlisten: listen,\n\tconnect: connect,\n\tapply: apply\n};\n\n\n},{}]},{},[1]);\n"],"sourceRoot":"/source/"}